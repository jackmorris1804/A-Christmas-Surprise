<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <title>ğŸ„ A Christmas Surprise ğŸ„</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <canvas id="scene" aria-label="Christmas forest scene"></canvas>

  <!-- UI overlays -->
  <div id="intro" class="overlay center">
    <!-- Stage 1: Closed Envelope -->
    <div id="envelopeContainer" class="envelope-container">
      <div class="envelope closed">
        <div class="envelope-back"></div>
        <div class="envelope-flap"></div>
        <div class="envelope-seal">ğŸ„</div>
      </div>
    </div>
    
    <!-- Stage 2: Letter (hidden initially) -->
    <div id="letter" class="letter hidden">
      <div class="letter-content">
        <h1>ğŸ„ A Christmas Surprise ğŸ„</h1>
        <p style="font-size: 18px; margin: 20px 0; color: #c41e3a;">
          <strong>For Beatrice - from Jack â¤ï¸</strong>
        </p>
        <p style="font-size: 16px; line-height: 1.8; color: #4a5568; margin: 25px 0;">
          To my silly goose,<br><br>
          This year has been a tough one, so I wanted to make you something for all the good memories.<br><br>
          Each stop along the way holds a special moment we've shared together.<br><br>
          I hope you have enjoy your Christmas present...<br>
        </p>
        <button id="startBtn" class="primary">Let's Go! ğŸ…</button>
        <p class="tiny" style="margin-top: 15px; color: #718096;">Tip: switch off iPhone Silent Mode for audio ğŸ§</p>
      </div>
    </div>
  </div>

  <div id="hud" class="hud hidden" aria-live="polite">
    <button id="muteBtn" class="chip" aria-label="Toggle audio">Play Music</button>
  </div>

  <div id="prompt" class="overlay hidden" role="dialog" aria-modal="true">
    <div class="card">
      <h2 id="promptTitle">We've arrived</h2>
      <p id="promptText">Go inside this gingerbread house to view the memory, or keep walking?</p>
      <div class="row gap">
        <button id="viewBtn" class="secondary" aria-label="View memory inside the house">View Memory</button>
        <button id="continueBtn" class="primary" aria-label="Continue walking">Keep Walking</button>
      </div>
    </div>
  </div>

  <div id="memory" class="overlay hidden" role="dialog" aria-modal="true">
    <div class="card">
      <h2 id="memoryTitle">Memory</h2>
      <div style="position: relative;">
        <img id="memoryImg" alt="Memory photo" />
        <div style="position: absolute; top: 50%; left: 10px; transform: translateY(-50%);">
          <button id="prevImageBtn" class="chip" style="font-size: 20px; padding: 8px 12px;" aria-label="Previous image">â†</button>
        </div>
        <div style="position: absolute; top: 50%; right: 10px; transform: translateY(-50%);">
          <button id="nextImageBtn" class="chip" style="font-size: 20px; padding: 8px 12px;" aria-label="Next image">â†’</button>
        </div>
      </div>
      <p id="imageCounter" style="font-size: 14px; color: #888; margin: 5px 0;" aria-live="polite">1 / 3</p>
      <button id="closeMemoryBtn" class="primary" aria-label="Close memory and continue journey">Continue</button>
    </div>
  </div>

  <div id="flowersPrompt" class="overlay hidden" role="dialog" aria-modal="true">
    <div class="card">
      <h2 style="margin-top:0">ğŸŒ¸ Memories with Nanny & Grandma ğŸ•Šï¸</h2>
      <p>Would you like to leave these flowers outside for Nanny and Grandma?</p>
      <div style="display:flex; gap:12px; margin-top:12px;">
        <button id="flowersYes" class="btn primary" aria-label="Leave flowers as a tribute">Leave Flowers</button>
        <button id="flowersNo" class="btn btn-secondary" aria-label="Keep walking without leaving flowers">Keep Walking</button>
      </div>
    </div>
  </div>

  <div id="presentsPrompt" class="overlay hidden" role="dialog" aria-modal="true">
    <div class="card">
      <h2 style="margin-top:0">Would you like your presents now?</h2>
      <p>Santa can take you straight to the North Pole ğŸ…âœ¨</p>
      <div style="display:flex; gap:12px; margin-top:12px;">
        <button id="presentsYes" class="btn" aria-label="Accept ride to North Pole">Yes, take me there</button>
        <button id="presentsNo" class="btn btn-secondary" aria-label="Decline ride to North Pole">Not yet</button>
      </div>
    </div>
  </div>

  <div id="northPole" class="overlay hidden" role="dialog" aria-modal="true">
    <div class="card">
      <h2>ğŸ… Welcome to the North Pole! ğŸ</h2>
      <p id="giftMessage">
        Merry Christmas, Silly Goose! ğŸ„âœ¨<br><br>
        You'll have to wait to open your presentsâ€¦ but here's a hint:
        it's something we'll enjoy together. Love, Jack.
      </p>
      <button id="restartBtn" class="secondary" aria-label="Restart the journey from the beginning">Restart Journey</button>
    </div>
  </div>

  <script type="module" src="app.js"></script>
</body>
</html>
